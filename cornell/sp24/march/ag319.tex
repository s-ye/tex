\documentclass[12pt]{article}
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{/Users/songye03/Desktop/math_tex/style/quiver}
\usepackage{/Users/songye03/Desktop/math_tex/style/scribe}

\begin{document}
Songyu Ye

\today

\hfill

This is an exposition of Cartier divisors, line bundles, 
the exact sequences of the relative tangent exact sequence and the relative normal exact sequence, and the adjunction formula.

\section{Cartier divisors and line bundles}
We let $K_X^*$ denote the sheaf of non-zero rational functions on $X$ and $\mathcal{O}_X^*$ the sheaf of non-zero regular functions on $X$.
Note that if $X$ is an integral scheme then $K_X^*$ is a constant sheaf and in particular is the function field of the global sections of $\cO_X$
\begin{definition}
    A \textbf{Cartier divisor} on a scheme $X$ is a collection of open affine subsets $U_i$ and non-zero elements $f_i\in K^*(U_i)$ 
    so that $f_i/f_j\in \mathcal{O}_X^*(U_i\cap U_j)$. In particular, a Cartier divisor is a global section of the quotient sheaf
    $K_X^*/\mathcal{O}_X^*$. A \textbf{principal Cartier divisor} is a Cartier divisor where the $f_i$ come from one particular global section of $K_X^*$.
\end{definition}

Notice that Cartier divisor is just a bunch of local data. One can repackage this local data into a sheaf. 
\begin{definition}
    Let $D = \{U_i,f_i\}$ be a Cartier divisor. Then the sheaf $\cL(D)$ is the sheaf of $\cO_X$-submodule of $K_X$ generated by $\inv{f_i}$ on $U_i$.
    This is a line bundle and it gives a 1-1 correspondence between Cartier divisors and subsheaves of $K_X$ that are locally free of rank 1.
\end{definition}

When $X$ is integral, this gives an isomorphism between the group of Cartier divisors and the group of line bundles on $X$, both sides up to isomorphism. The necessity of the condition that $X$ is integral is that the function field is a constant sheaf and therefore every invertible sheaf is isomorphic to a subsheaf of the constant sheaf.

\hfill

Recall that closed subschemes of $X$ are in bijection with quasi-coherent sheaves of ideals $\cI$ of $\cO_X$. In particular there is a 
short exact sequence of sheaves \begin{align*}
    0\to \cI\to \cO_X\to \cO_X/\cI\to 0
\end{align*} The ideal sheaf $\cI$ locally cuts out a closed subscheme of $X$ and the cokernel is the sheaf of regular functions on the
closed subscheme. 

\begin{definition}
    An \textbf{effective Cartier divisor} is a Cartier divisor that is locally cut out by a single \textbf{regular} function. This is equivalent to saying that the Cartier divisor cuts out a closed subscheme of $X$ which is locally principal. 
\end{definition}

\begin{proposition}
    The ideal sheaf of an effective Cartier divisor is isomorphic to $\cO_X(-D)$ where $D$ is the associated Cartier divisor.
\end{proposition}

\begin{proof}
    Look at the transition functions.
\end{proof}

An effective Cartier divisor corresponds to a line bundle $\cL(D)$ which necessarily has a global section. This is the section that cuts out the effective Cartier divisor. In particular, since $\cL(D) = \Hom(\cI,\cO_X)$, the global section can be taken as the inclusion $\cI \to \cO_X$.


\section{Geometry}
We now present the relative tangent exact sequence and the relative normal exact sequence.
It is very important to keep in mind the geometry of the story. 

\begin{definition}
    Let $\phi:X\to Y$ be a submersive (tangent map is onto at each point) map of smooth manifolds.
    There is an induced map of bundles on $X$ denoted $T\phi:TX\to \phi^*TY$.
    The \textbf{relative tangent bundle} is the kernel of the tangent map, denoted by $T_{X/Y}$.
    The \textbf{relative cotangent bundle} is $T^*_{X/Y} = T_X^*/\im(\phi^*(T_Y^*))$ is the dual of the relative tangent bundle.
\end{definition}

\begin{example}
    For a submersion of manifolds, one might hope that the tangent spaces to the fibers at each point $p\in X$
    fit together to form a vector bundle. This is precisely the relative tangent bundle.
\end{example}

Say we have submersions $X\to Y\to Z$ of smooth manifolds and for the sake of understanding suppose that $Z$ is a point. Let $p\in X$.
Then the tangent space of the fiber of $\pi:X\to Y$ at $p$ is a subspace of the tangent space of the total space of $X$ at $p$. The cokernel 
is naturally the pullback of the tangent space of $Y$ at $\pi(p)$. The idea is that we 
should be able to fit all of these cokernels together to form a vector bundle on $X$. This is precisely the short exact seuqence
of tangent sheaves \begin{align*}
    0\to T_{X/Y}\to T_{X/Z}\to \pi^*T_{Y/Z}\to 0
\end{align*}



\begin{definition}
    Given a submanifold $X\subset Y$, we can consider two vector bundles on $X$, namely the tangent bundle $TX$ and the 
    restriction of the tangent bundle of $Y$ to $X$, denoted $TY|_X$. The \textbf{normal bundle} $N_{X/Y}$ is the cokernel
    of the inclusion map $TX\to TY|_X$. In the smooth category the normal bundle is isomorphic
    to a tubular neighborhood of $X$ in $Y$.
\end{definition}

It follows that we have an exact seuqence of bundles on $X$ \begin{align*}
    0\to TX\to TY|_X\to N_{X/Y}\to 0
\end{align*} which corresponds to the relative normal sequence.
Dualizing yields \begin{align*}
    0\to N^*_{X/Y}\to (TY|_X)^*\to (TX)^*\to 0
\end{align*}

\section{Algebra}
\subsection{Sheaf of differentials}
\begin{definition}
    Let $A$ be a $B$-algebra and $\phi:B\to A$ the structure map. The \textbf{module of differentials} $\Omega_{A/B}$ is the
    $A$ module generated by symbols $da$ for $a\in A$ subject to the linearity, Leibniz relations and the fact that derivation of a 
    constant is zero.
\end{definition}

\begin{example}
    If $A = B/I$ then $\Omega_{A/B} = 0$ because $da = 0$. In particular a closed affine subscheme has zero relative tangent vectors.
\end{example}

\begin{theorem}
    [Affine cotangent exact sequence] Suppose $C\to B\to A$ are ring morphisms.
    Then there is a natural exact sequence of $A$-modules \begin{align*}
        \Omega_{B/C}\otimes_B A\to \Omega_{A/C}\to \Omega_{A/B}\to 0
    \end{align*}
\end{theorem}
The second map is the identity map on symbols. We have exactness because the term on the right 
has the same relations and more, precisely those $db$ for $b\in B$. These relations come from 
the image of the map $a \otimes db \mapsto adb$.

\hfill

The derivations $d:B\to \Omega_{B/C}$ glue together to give a map $d:\cO_X \to \Omega_{X/Y}$, which is a
derivation of local rings at each point. Note that the space of derivations of local rings is precisely the 
Zariski tangent space at that point.

\begin{theorem}
    [Affine conormal exact sequence] Suppose $B$ is a $C$-algebra, $I$ an ideal of $B$ and $A = B/I$.
    Then there is a natural exact sequence of $A$-modules \begin{align*}
        I/I^2\to \Omega_{B/C}\otimes_B A\to \Omega_{A/C}\to 0
    \end{align*}
\end{theorem}
The first map is $i \mapsto 1\otimes di$ (one has to check that the map descends to $I/I^2$). The second map is $a\otimes db\mapsto adb$.

One should think of this as parallel to the geometry \begin{align*}
    0\to N_{X/Y}^*\to (TY|_X)^*\to (TX)^*\to 0 \\
    0 \to \cI/\cI^2\to \Omega_{X}\vert_Y\to \Omega_Y \to 0
\end{align*}
One has to say some words to convince themself that the isomorphisms glue globally to give the exact sequences of sheaves. Also smoothness is about the sequence being exact on the left.

\hfill

In particular if $X\to Y$ is a closed embedding of schemes cut out by ideal sheaf $\mathcal{I}$,
then we define the \textbf{conormal sheaf} $\mathcal{I}/\mathcal{I}^2$ and the \textbf{normal sheaf} as its dual.
In good situations when the embedding is regular the normal sheaf is locally free of finite rank and therefore 
defines a vector bundle on $X$.

\begin{example}
    In particular this occurs when $S\subset X$ is an effective Cartier divisor. We have the isomorphism \begin{align*}
        N_{S/X}^* = \cO_S(-S) = \cI_S
    \end{align*} Suppose that $S$ is locally cut out by the functions $f_\alpha$ and on overlaps we have \begin{align*}
        f_\beta = u_{\alpha\beta}f_\alpha
    \end{align*} where $u_{\alpha\beta}$ is a unit. Thus the ideal sheaf \begin{align*}
        \cI_S = \cO_S(-S) 
    \end{align*} is a line bundle with transition functions $u_{\alpha\beta}$.

    \hfill

    Consider the differential form $df_\alpha$. This is a section of $T_X^*\vert_{U_\alpha}$ and by restriction we get 
    a section of the conormal bundle $N_{S/X}^*$. We have \begin{align*}
        df_\beta = d(u_{\alpha\beta}f_\alpha) = du_{\alpha\beta} f_\alpha + u_{\alpha\beta}df_\alpha = 
        u_{\alpha\beta}df_\alpha
    \end{align*} because $f_\alpha$ vanishes on $S$. Thus $N_{S/X}^*$ has the same transition functions as $\cI_S$.
\end{example}

\section{Canonical divisor and adjunction formula}

\begin{definition}
    The canonical bundle on a smooth scheme $X$ is the top exterior power of the cotangent bundle, denoted $\omega_X = \wedge^{\dim X}\Omega_{X/k}$. The \textbf{canonical divisor} is the divisor associated to the line bundle $\omega_X$. In particular look at the zeros and poles of 
    any rational section of $\omega_X$.
\end{definition}

\begin{theorem}
    [Adjunction formula] Let $X$ be a smooth scheme and $S\subset X$ a smooth closed subscheme. Then \begin{align*}
        (K_X + S)\vert_S = K_S
    \end{align*}
\end{theorem}

\begin{proof}
    The canonical divisor can also be realized as the first Chern class of the cotangent bundle. We have the short exact sequence
    \begin{align*}
        0 \to T_S \to T_X\vert_S \to N_{S/X}\to 0
    \end{align*}
    Taking first Chern classes gives us \begin{align*}
        -K_X = -K_S + c_1(N_{S/X})
    \end{align*}
    and the result follows.
\end{proof}

\section{Sheaf of relative differentials}
Let $f:X\to Y$ be a morphism of schemes. There is a diagonal morphism $\Delta:X\to X\times_Y X$ which is an
isomorphism onto its image, which is a locally closed subscheme of $X\times_Y X$. This means that there is 
some open $W\subset X\times_Y X$ so that $\Delta(X)$ is closed in $W$. Let $\cI$ denote the
sheaf of ideals of $\Delta(X)$ in $W$.

\begin{definition}
    The \textbf{sheaf of relative differentials} of $X$ over $Y$ is the sheaf \begin{align*}
        \Omega_{X/Y} = \Delta^*(\cI/\cI^2)
    \end{align*}
\end{definition}

\section{After meeting}
Mike pointed out a very interesting example.
Suppose that $X = \P^2$ and $S = V(f)$ is some degree $d$ hypersurface.

We want to consider the conormal sheaf $I/I^2$ of $S$ in $X$. The point is that there is an isomorphism \begin{align*}
    I/I^2 = \C[x_0,x_1,x_2]/I
\end{align*} where $f \mapsto 1$. However in order to make it a map of graded modules we need to
twist by $-d$. This shows that \begin{align*}
    I/I^2 = \cO_S(-d)
\end{align*} which is a simple version of the more general result \begin{align*}
    N_{S/X}^* = \cO_S(-S)
\end{align*}

\red{Mike said we should take some time to play with the adjunction formula and really verify what it is saying} Some good examples he pointed us to look at were the rational normal scrolls.

\hfill

One way he described a particular rational normal scroll is the locus of lines in $\P^4$ which meet a fixed conic and a fixed line. He said that he learned this from Joe and David at a summer school some number
of years ago.

\section{References}
\begin{itemize}
    \item Eisenbud Commutative Algebra with a View Toward Algebraic Geometry
    \item Vakil Foundations of Algebraic Geometry
    \item \url{https://math.mit.edu/~mckernan/Teaching/07-08/Autumn/18.735/18.735.html} (Lecture 2)
    
\end{itemize}

\end{document}